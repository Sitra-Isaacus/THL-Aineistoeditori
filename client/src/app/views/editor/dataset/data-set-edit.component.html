<div *ngIf="dataset">

  <h1>
    {{ 'dataset' | translate }}:
    {{dataset.prefLabel | lang}}
  </h1>

  <div class="form-group">
    <label for="prefLabel">{{ 'prefLabel' | translate }}</label>
    <input [(ngModel)]="dataset.prefLabel[language]"
        id="prefLabel"
        name="prefLabel"
        type="text"
        class="form-control">
  </div>

  <div class="form-group">
    <label for="altLabel" translate="altLabel"></label>
    <input [(ngModel)]="dataset.altLabel[language]"
        id="altLabel"
        name="altLabel"
        class="form-control"
        type="text">
  </div>

  <div class="form-group">
    <label for="abbreviation" translate="abbreviation"></label>
    <input [(ngModel)]="dataset.abbreviation[language]"
        id="abbreviation"
        name="abbreviation"
        class="form-control"
        type="text">
  </div>

  <div *ngIf="allOrganizations"
      class="form-group">
    <label for="ownerOrganization">{{ 'organization' | translate }}</label>
    <select [(ngModel)]="dataset.owner"
        [compareWith]="nodeUtils.equals"
        id="ownerOrganization"
        class="form-control">
      <option [ngValue]="null"></option>
      <option *ngFor="let organization of allOrganizations"
          [ngValue]="organization">
          {{organization.prefLabel | lang}}
    </option>
  </select>
</div>
<!--
<div *ngIf="allOrganizationUnits" class="form-group">
  <label for="ownerOrganizationUnit" translate="organizationUnit"></label>
<select [(ngModel)]="dataset.ownerOrganizationUnit"
        [compareWith]="nodeUtils.equals"
        id="ownerOrganizationUnit"
        class="form-control">
  <option [ngValue]="null"></option>
  <option *ngFor="let organizationUnit of allOrganizationUnits"
          [ngValue]="organizationUnit">
    {{organizationUnit.prefLabel | lang}}
  </option>
</select>
</div>
-->

<div class="form-group">
  <label for="description">{{ 'description' | translate }}</label>
  <textarea [(ngModel)]="dataset.description[language]"
      id="description"
      name="description"
      class="form-control"
      rows="6">
  </textarea>
</div>

<div class="form-group">
  <label for="researchProjectURL" translate="researchProjectURL"></label>
  <input [(ngModel)]="dataset.researchProjectURL[language]"
      id="researchProjectURL"
      name="researchProjectURL"
      class="form-control"
      type="text">
</div>

<div class="form-group">
  <label for="registryPolicy" translate="registryPolicy"></label>
  <textarea [(ngModel)]="dataset.registryPolicy[language]"
      id="registryPolicy"
      name="registryPolicy"
      class="form-control"
      rows="6">
  </textarea>
</div>

<div *ngIf="allUsageConditions"
    class="form-group">
  <label for="usageCondition">{{ 'usageCondition' | translate }}</label>
  <select [(ngModel)]="dataset.usageCondition"
      [compareWith]="nodeUtils.equals"
      id="usageCondition"
      class="form-control">
    <option [ngValue]="null"></option>
    <option *ngFor="let usageCondition of allUsageConditions"
        [ngValue]="usageCondition">
        {{usageCondition.prefLabel|lang}}
  </option>
</select>
</div>

  <div class="form-group">
    <label for="usageConditionAdditionalInformation">{{ 'usageConditionAdditionalInformation' | translate }}</label>
    <textarea [(ngModel)]="dataset.usageConditionAdditionalInformation[language]"
              id="usageConditionAdditionalInformation"
              name="usageConditionAdditionalInformation"
              class="form-control"
              rows="2">
    </textarea>
  </div>

  <div class="form-group">
    <label for="population-prefLabel">{{ 'population' | translate }}</label>
    <textarea [(ngModel)]="dataset.population.prefLabel[language]"
              id="population-prefLabel"
              name="population-prefLabel"
              class="form-control"
              rows="3">
    </textarea>
  </div>

  <div class="form-group">
    <label for="population-geographicalCoverage">{{ 'geographicalCoverage' | translate }}</label>
    <textarea [(ngModel)]="dataset.population.geographicalCoverage[language]"
              id="population-geographicalCoverage"
              name="population-geographicalCoverage"
              class="form-control"
              rows="2">
    </textarea>
  </div>

  <div class="form-group">
    <label for="population-sampleSize">{{ 'sampleSize' | translate }}</label>
    <input [(ngModel)]="dataset.population.sampleSize[language]"
           id="population-sampleSize"
           name="population-sampleSize"
           type="text"
           class="form-control">
  </div>

  <div class="form-group">
    <label for="population-loss">{{ 'loss' | translate }}</label>
    <input [(ngModel)]="dataset.population.loss[language]"
           id="population-loss"
           name="population-loss"
           type="text"
           class="form-control">
  </div>

<div class="form-group">
  <label for="referencePeriodStart">{{ 'referencePeriodStart' | translate }}</label>
  <iso-datepicker
      [(dateAsString)]="dataset.referencePeriodStart"
      id="referencePeriodStart"
      name="referencePeriodStart">
  </iso-datepicker>
</div>

<div class="form-group">
  <label for="referencePeriodEnd">{{ 'referencePeriodEnd' | translate }}</label>
  <iso-datepicker
      [(dateAsString)]="dataset.referencePeriodEnd"
      id="referencePeriodEnd"
      name="referencePeriodEnd">
  </iso-datepicker>
</div>

<div *ngIf="allLifecyclePhases"
    class="form-group">
  <label for="lifecyclePhase" translate="lifecyclePhase"></label>
  <select [(ngModel)]="dataset.lifecyclePhase"
      [compareWith]="nodeUtils.equals"
      id="lifecyclePhase"
      class="form-control">
    <option [ngValue]="null"></option>
    <option *ngFor="let lifecyclePhase of allLifecyclePhases"
        [ngValue]="lifecyclePhase">
        {{lifecyclePhase.prefLabel|lang}}
  </option>
</select>
</div>

<div class="form-group">
  <label for="comment" translate="comment"></label>
  <textarea [(ngModel)]="dataset.comment"
      id="comment"
      name="comment"
      class="form-control"
      rows="2"
      thlAutogrow>
  </textarea>
</div>

<div class="row">
  <div class="col-xs-12">
    <h2>{{ 'variables' | translate }}</h2>

    <table
        *ngIf="(dataset.instanceVariables && dataset.instanceVariables.length); else noInstanceVariables;"
        class="table table-striped table-hover">
        <tr>
        <th>{{ 'prefLabel' | translate }}</th>
        <th>{{ 'description' | translate }}</th>
        <th>{{ 'referencePeriod' | translate }}</th>
        <th>{{ 'functions' | translate }}</th>
      </tr>
      <tr *ngFor="let variable of dataset.instanceVariables">
          <td>
          {{ variable.prefLabel | lang }}
        </td>
        <td>
          {{ variable.description | lang }}
        </td>
        <td>
      <ng-container
          *ngIf="(variable.referencePeriodStart || variable.referencePeriodEnd); else inheritedReferencePeriod;">
          {{ variable.referencePeriodStart | lang }}
          â€”
          {{ variable.referencePeriodEnd | lang }}
    </ng-container>
    <ng-template #inheritedReferencePeriod>
      {{ 'inheritedReferencePeriod' | translate }}
    </ng-template>
    </td>
    <td>
      <button
          routerLink="/editor/datasets/{{ dataset.id }}/instanceVariables/{{ variable.id }}/edit"
          class="btn btn-default btn-sm">
        <span class="glyphicon glyphicon-edit"></span>
        {{ 'edit' | translate }}
      </button>
    </td>
    </tr>
  </table>

  <ng-template #noInstanceVariables>
    <p>{{ 'noInstanceVariables' | translate }}</p>
  </ng-template>

  <button class="btn btn-default"
          routerLink="/editor/datasets/{{ dataset.id }}/instanceVariables/new">
    <span class="glyphicon glyphicon-plus"></span>
    {{ 'addInstanceVariable' | translate }}
  </button>
</div>
</div>

<hr>

<div>
  <button class="btn btn-default" (click)="goBack()">
    <span class="glyphicon glyphicon-chevron-left"></span>
    {{ 'cancel' | translate }}
  </button>
  <button class="btn btn-primary" (click)="save()">
    <span class="glyphicon glyphicon-floppy-disk"></span>
    {{ 'save' | translate }}
  </button>
</div>

</div>
